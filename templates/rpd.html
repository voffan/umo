{% extends 'base.html' %}
{% block title %}Добавление рабочей программы дисциплины{% endblock %}
{% block content %}
    <form action="{% url 'rpds:rpd' discipline.id %}" method="POST" class="post-form">
        {% csrf_token %}
        <div id="page1">
            <h1>1. Аннотация</h1>
            <h2 align="center">к рабочей программе дисциплины</h2>
            <h2 align="center">{{ discipline.code }} {{ discipline.Name }}</h2>
            <h5 align="justify">1.1. Цель освоения и краткое содержание дисциплины</h5>
            {{ form.goal.label_tag}}
            {{ form.goal }}
            {{ form.abstract.label_tag }}
            {{ form.abstract }}

            <h5 align="justify">1.2. Перечень планируемых результатов обучения по дисциплине, соотнесенных с планируемыми результатами освоения образовательной программы</h5>
            {{ results.management_form }}
            <table id=results class="table table-sm">
                {% for form in results %}
                    {% if forloop.first %}
                        <thead align="center" class="thead-dark">
                            {% for field in form %}
                                <th {% if forloop.last %} style="display:None" {% endif %}>{{ field.label_tag }}</th>
                            {% endfor %}
                            <th></th>
                        </thead>
                    {% endif %}
                    <tbody align="center">
                        <tr>
                            {% for field in form %}
                                <td {% if forloop.last %} style="display:None" {% endif %}>{{ field }}
                            {% endfor %}
                            <td><button type="button" class="btn btn-danger btn-sm" onclick="deleteRow(this)">Удалить строку</button></td>
                        </tr>
                    </tbody>
                {% endfor %}
            </table>
            <div align="right" class="ml-auto mr-4">
                  <button type="button" class="btn btn-success" onclick="addRow('results');return false;">Добавить строку</button>
            </div>

            <h5 align="justify">1.3. Место дисциплины в структуре ОПОП</h5>
            {{ basement.management_form }}
            <table id=basement align="center" class="table table-sm">
                {% for form in basement %}
                    {% if forloop.first %}
                        <thead align="center" class="thead-dark">
                            {% for field in form %}
                                <th {% if forloop.last %} style="display:None" {% endif %}>{{ field.label_tag }}</th>
                            {% endfor %}
                            <th></th>
                        </thead>
                    {% endif %}
                    <tbody align="center">
                        <tr>
                            {% for field in form %}
                                <td {% if forloop.last %} style="display:None" {% endif %}>{{ field }}
                            {% endfor %}
                            <td><button type="button" class="btn btn-danger btn-sm" onclick="deleteRow(this)">Удалить строку</button></td>
                        </tr>
                    </tbody>
                {% endfor %}
            </table>
            <div align="right" class="ml-auto mr-4">
                <button type="button" class="btn btn-success" onclick="addRow('basement');return false;">Добавить строку</button>
            </div>
            <h5 align="justify">1.4. Язык преподавания:</h5>
            {{ form.language }}
        </div>

        <div id="page2" style="display:none">
            <h5 align="justify">2. Объем дисциплины в зачетных единицах с указанием количества академических часов, выделенных на контактную работу обучающихся с преподавателем (по видам учебных занятий) и на самостоятельную работу обучающихся</h5>
            <label>Вручную пользователем не вводится</label>
        </div>

        <div id="page3" style="display:none">
            <h5 align="justify">3. Содержание дисциплины, структурированное по темам с указанием отведенного на них количества академических часов и видов учебных занятий</h5>
            <h5 align="center">3.1. Распределение часов по темам и видам учебных занятий</h5>
            {{ hours_distribution.management_form }}
            <table id=hours_distribution class="table table-sm">
                {% for form in hours_distribution %}
                    {% if forloop.first %}
                        <thead align="center" class="thead-dark">
                            {% for field in form %}
                                <th {% if forloop.last %} style="display:None" {% endif %}>{{ field.label_tag }}</th>
                            {% endfor %}
                                <th></th>
                        </thead>
                    {% endif %}
                    <tbody align="center">
                        <tr>
                            {% for field in form %}
                                <td {% if forloop.last %} style="display:None" {% endif %}>{{ field }}</td>
                            {% endfor %}
                            <td><button type="button" class="btn btn-danger btn-sm" onclick="deleteRow(this)">Удалить строку</button></td>
                        </tr>
                    </tbody>
                {% endfor %}
            </table>
            <div align="right" class="ml-auto mr-4">
                  <button type="button" class="btn btn-success" onclick="addRow('hours_distribution');return false;">Добавить строку</button>
            </div>

            <h5 align="center">3.2. Содержание тем программы дисциплины</h5>
            {{ theme.management_form }}
            <table id=theme class="table table-sm">
                {% for form in theme %}
                    {% if forloop.first %}
                        <thead align="center" class="thead-dark">
                            {% for field in form %}
                                 <th {% if forloop.last %} style="display:None" {% endif %}>{{ field.label_tag }}</th>
                            {% endfor %}
                            <th></th>
                        </thead>
                    {% endif %}
                    <tbody align="center">
                        <tr>
                            {% for field in form %}
                                <td {% if forloop.last %} style="display:None" {% endif %}>{{ field }}</td>
                            {% endfor %}
                            <td><button type="button" class="btn btn-danger btn-sm" onclick="deleteRow(this)">Удалить строку</button></td>
                        </tr>
                    </tbody>
                {% endfor %}
            </table>
            <div align="right" class="ml-auto mr-4">
                  <button type="button" class="btn btn-success" onclick="addRow('theme');return false;">Добавить строку</button>
            </div>

            <h5 align="justify">3.3. Формы и методы проведения занятий, применяемые учебные технологии</h5>
            {{ form.education_methodology.label_tag }}
            {{ form.education_methodology }}
        </div>

        <div id="page4" style="display:none">
            <h5 align="center">4. Перечень учебно-методического обеспечения для самостоятельной работы обучающихся по дисциплине</h5>
            {{ form.count_e_method_support.label_tag }}
            {{ form.count_e_method_support }}
            <h5 align="center">Содержание СРС</h5>
            {{ srs_content.management_form }}
            <table id=srs_content class="table table-sm">
                    {% for form in srs_content %}
                        {% if forloop.first %}
                            <thead align="center" class="thead-dark">
                                {% for field in form %}
                                    <th {% if forloop.last %} style="display:None" {% endif %}>{{ field.label_tag }}</th>
                                {% endfor %}
                            </thead>
                        {% endif %}
                        <th></th>
                        <tbody align="center">
                            <tr>
                                {% for field in form %}
                                    <td {% if forloop.last %} style="display:None" {% endif %}>{{ field }}</td>
                                {% endfor %}
                                <td><button type="button" class="btn btn-danger btn-sm" onclick="deleteRow(this)">Удалить строку</button></td>
                            </tr>
                        </tbody>
                    {% endfor %}
            </table>
            <div align="right" class="ml-auto mr-4">
                  <button type="button" class="btn btn-success" onclick="addRow('srs_content');return false;">Добавить строку</button>
            </div>
            <h5 align="center">Лабораторные работы или лабораторные практикумы</h5>
            {{ labs_content.management_form }}
            <table id=labs_content class="table table-sm">
                {% for form in labs_content %}
                    {% if forloop.first %}
                        <thead align="center" class="thead-dark">
                            {% for field in form %}
                                <th {% if forloop.last %} style="display:None" {% endif %}>{{ field.label_tag }}</th>
                            {% endfor %}
                        </thead>
                    {% endif %}
                    <th></th>
                    <tbody align="center">
                        <tr>
                            {% for field in form %}
                                <td {% if forloop.last %} style="display:None" {% endif %}>{{ field }}</td>
                            {% endfor %}
                            <td><button type="button" class="btn btn-danger btn-sm" onclick="deleteRow(this)">Удалить строку</button></td>
                        </tr>
                    </tbody>
                {% endfor %}
            </table>
            <div align="right" class="ml-auto mr-4">
                  <button type="button" class="btn btn-success" onclick="addRow('labs_content');return false;">Добавить строку</button>
            </div>
        </div>

        <div id="page5" style="display:none">
            <h5 align="justify">5. Методические указания для обучающихся по освоению дисциплины</h5>
            {{ form.methodological_instructions.label_tag }}
            {{ form.methodological_instructions }}
            <h5 align="justify">Рейтинговый регламент по дисциплине:</h5>
            {{ disc_rating.management_form }}
            <table id=disc_rating class="table table-sm">
                {% for form in disc_rating %}
                    {% if forloop.first %}
                        <thead align="center" class="thead-dark">
                            {% for field in form %}
                                <th {% if forloop.last %} style="display:None" {% endif %}>{{ field.label_tag }}</th>
                            {% endfor %}
                        </thead>
                    {% endif %}
                    <th></th>
                    <tbody align="center">
                        <tr>
                            {% for field in form %}
                                <td {% if forloop.last %} style="display:None" {% endif %}>{{ field }}</td>
                            {% endfor %}
                            <td><button type="button" class="btn btn-danger btn-sm" onclick="deleteRow(this)">Удалить строку</button></td>
                        </tr>
                    </tbody>
                {% endfor %}
            </table>
            <div align="right" class="ml-auto mr-4">
                  <button type="button" class="btn btn-success" onclick="addRow('disc_rating');return false;">Добавить строку</button>
            </div>
        </div>

        <div id="page6" style="display:none">
            <h5 align="justify">6. Фонд оценочных средств для проведения промежуточной аттестации обучающихся по дисциплине</h5>
            {{ form.fos_fond.label_tag }}
            {{ form.fos_fond }}
            <h5 align="center">6.1. Показатели, критерии и шкала оценивания</h5>
            {{ mark_scale.management_form }}
            <table id=mark_scale class="table table-sm">
                {% for form in mark_scale %}
                    {% if forloop.first %}
                        <thead align="center" class="thead-dark">
                            {% for field in form %}
                                <th {% if forloop.last %} style="display:None" {% endif %}>{{ field.label_tag }}</th>
                            {% endfor %}
                        </thead>
                    {% endif %}
                    <th></th>
                    <tbody align="center">
                        <tr>
                            {% for field in form %}
                                <td {% if forloop.last %} style="display:None" {% endif %}>{{ field }}</td>
                            {% endfor %}
                            <td><button type="button" class="btn btn-danger btn-sm" onclick="deleteRow(this)">Удалить строку</button></td>
                        </tr>
                     </tbody>
                {% endfor %}
            </table>
            <div align="right" class="ml-auto mr-4">
                  <button type="button" class="btn btn-success" onclick="addRow('mark_scale');return false;">Добавить строку</button>
            </div>

            <h5 align="center">6.2. Примерные контрольные задания (вопросы) для промежуточной аттестации</h5>
            {{ form.fos_methodology.label_tag }}
            {{ form.fos_methodology }}
            {{ fos_table.management_form }}
            <table id=fos class="table table-sm">
                {% for form in fos_table %}
                    {% if forloop.first %}
                        <thead align="center" class="thead-dark">
                            {% for field in form %}
                                <th {% if forloop.last %} style="display:None" {% endif %}>{{ field.label_tag }}</th>
                            {% endfor %}
                        </thead>
                        {% endif %}
                    <th></th>
                    <tbody align="center">
                        <tr>
                            {% for field in form %}
                                <td {% if forloop.last %} style="display:None" {% endif %}>{{ field }}</td>
                            {% endfor %}
                            <td><button type="button" class="btn btn-danger btn-sm" onclick="deleteRow(this)">Удалить строку</button></td>
                        </tr>
                    </tbody>
                {% endfor %}
            </table>
            <div align="right" class="ml-auto mr-4">
                  <button type="button" class="btn btn-success" onclick="addRow('fos');return false;">Добавить строку</button>
            </div>

            <h5 align="center">6.3. Методические материалы, определяющие процедуры оценивания</h5>
            {{ form.scaling_methodology.label_tag }}
            {{ form.scaling_methodology }}
        </div>

        <div id="page7" style="display:none">
            <h5 align="center">7. Перечень основной и дополнительной учебной литературы, необходимой для освоения дисциплины </h5>
            <label>Примечание: Для обозначения основной литературы в строке "Главная литература" поставьте галочку.</label>
            {{ bibl.management_form }}
            <table id=mainlit class="table table-sm">
                {% for form in bibl %}
                    {% if forloop.first %}
                        <thead align="center" class="thead-dark">
                            {% for field in form %}
                                <th {% if forloop.last %} style="display:None" {% endif %}>{{ field.label_tag }}</th>
                            {% endfor %}
                        </thead>
                    {% endif %}
                    <th></th>
                    <tbody align="center">
                        <tr>
                            {% for field in form %}
                                <td {% if forloop.last %} style="display:None" {% endif %}>{{ field }}</td>
                            {% endfor %}
                            <td><button type="button" class="btn btn-danger btn-sm" onclick="deleteRow(this)">Удалить строку</button></td>
                        </tr>
                    </tbody>
                {% endfor %}
            </table>
            <div align="right" class="ml-auto mr-4">
                  <button type="button" class="btn btn-success" onclick="addRow('mainlit');return false;">Добавить строку</button>
            </div>
        </div>

        <div id="page8" style="display:none">
            <h5 align="center">8. Перечень ресурсов информационно-телекоммуникационной сети «Интернет» (далее сеть-Интернет), необходимых для освоения дисциплины</h5>
            {{ form.web_resource.label_tag }}
            {{ form.web_resource }}
        </div>

        <div id="page9" style="display:none">
            <h5 align="center">9. Описание материально-технической базы, необходимой для осуществления образовательного процесса по дисциплине</h5>
            {{ form.material.label_tag }}
            {{ form.material }}
        </div>

        <div id="page10" style="display:none">
            <h5 align="justify">10. Перечень информационных технологий, используемых при осуществлении образовательного процесса по дисциплине, включая перечень программного обеспечения и информационных справочных систем</h5>
            <h5 align="center">10.1. Перечень информационных технологий, используемых при осуществлении образовательного процесса по дисциплине </h5>
            {{ form.it.label_tag }}
            {{ form.it }}
            <h5 align="center">10.2. Перечень программного обеспечения </h5>
            {{ form.software.label_tag }}
            {{ form.software }}
            <h5 align="center">10.3. Перечень информационных справочных систем</h5>
            {{ form.iss.label_tag }}
            {{ form.iss }}
        </div>

        <div class="mt-4 row">
            <div class="ml-5">
                <button class="btn btn-dark" type="button" id="backward" onclick="goBackward();">назад</button>
            </div>
            <div class="ml-auto mr-5">
                <button class=" btn btn-dark" type="button" id="forward" onclick="goForward();">вперед</button>
            </div>
        </div>

        <br>
        <p align="center"><button type="submit" class="btn btn-success btn-lg">Сохранить</button>
        <a href= "{% url 'rpds:rpd_export' discipline.id %}" class="btn btn-primary btn-lg">Скачать</a>
        <a href= "{% url 'rpds:rpd_list' %}" class="btn btn-danger btn-lg">Отмена</a></p>
    </form>

{% endblock %}

{% block scripts %}
    let page1 = document.getElementById("page1");
    let page2 = document.getElementById("page2");
    let page3 = document.getElementById("page3");
    let page4 = document.getElementById("page4");
    let page5 = document.getElementById("page5");
    let page6 = document.getElementById("page6");
    let page7 = document.getElementById("page7");
    let page8 = document.getElementById("page8");
    let page9 = document.getElementById("page9");
    let page10 = document.getElementById("page10");
    let btnForward = document.getElementById("forward");
    let btnBackward = document.getElementById("backward");
    let page = 1;

    function goForward() {
        switch (page) {
            case 1:
                page += 1;
                page1.style.display = "none";
                page2.style.display = "block";
                break;
            case 2:
                page += 1;
                page2.style.display = "none";
                page3.style.display = "block";
                break;
            case 3:
                page += 1;
                page3.style.display = "none";
                page4.style.display = "block";
                break;
            case 4:
                page += 1;
                page4.style.display = "none";
                page5.style.display = "block";
                break;
            case 5:
                page += 1;
                page5.style.display = "none";
                page6.style.display = "block";
                break;
            case 6:
                page += 1;
                page6.style.display = "none";
                page7.style.display = "block";
                break;
            case 7:
                page += 1;
                page7.style.display = "none";
                page8.style.display = "block";
                break;
            case 8:
                page += 1;
                page8.style.display = "none";
                page9.style.display = "block";
                break;
            case 9:
                page += 1;
                page9.style.display = "none";
                page10.style.display = "block";
                break;
        }
    }
    function goBackward() {
        switch (page) {
            case 1:
                break;
            case 2:
                page -= 1;
                page1.style.display = "block";
                page2.style.display = "none";
                break;
            case 3:
                page -= 1;
                page2.style.display = "block";
                page3.style.display = "none";
                break;
            case 4:
                page -= 1;
                page3.style.display = "block";
                page4.style.display = "none";
                break;
            case 5:
                page -= 1;
                page4.style.display = "block";
                page5.style.display = "none";
                break;
            case 6:
                page -= 1;
                page5.style.display = "block";
                page6.style.display = "none";
                break;
            case 7:
                page -= 1;
                page6.style.display = "block";
                page7.style.display = "none";
                break;
            case 8:
                page -= 1;
                page7.style.display = "block";
                page8.style.display = "none";
                break;
            case 9:
                page -= 1;
                page8.style.display = "block";
                page9.style.display = "none";
                break;
            case 10:
                page -= 1;
                page9.style.display = "block";
                page10.style.display = "none";
                break;
        }
    }

    function addRow(id) {
        let tbody = document.getElementById(id).getElementsByTagName("tbody")[0];
        console.log(tbody);
        let tr = tbody.getElementsByTagName('tr')[0];
        tr.closest("tr");
        console.log(tr);
        let dupNode = tr.cloneNode(true);
        tbody.appendChild(dupNode);
    }

    function deleteRow(element) {
        console.log(element);
        let tr = element.closest('td').closest('tr');
        console.log(tr);
        let body = tr.closest('tbody');
        console.log(body);
        let count = body.getElementsByTagName('tr').length;
        console.log(count);
        if(count > 1) {
            tr.remove();
        }
    }
{% endblock %}